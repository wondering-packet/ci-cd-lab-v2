#!/usr/bin/env bash
set -euo pipefail
if [[ -f ".venv/bin/activate" ]]; then
  # shellcheck source=/dev/null
  source ".venv/bin/activate"
fi

# If requirements changed in the last merge, re-install
if git diff-tree -r --name-only --no-commit-id ORIG_HEAD HEAD | grep -qE '(^requirements\.txt$|^pyproject\.toml$)'; then
  echo "ğŸ” Detected tooling changes â†’ reinstalling deps..."
  python -m pip install --upgrade pip
  pip install -r requirements.txt
  pip install -e .
  echo "âœ… Tooling refreshed."
fi
